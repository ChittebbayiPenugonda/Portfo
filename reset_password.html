
<html>
	<head>
		<title>Password Reset</title>
		<meta property="og:title" content="Password Reset">
		<meta property="og:description" content="Change your password">
		<meta property="og:image" content="images/logo.png">
		<meta property="og:url" content="https://www.cssa.dev/"></meta>
		<meta name="google-signin-client_id" content="834594227639-dntdsbdaej8rsfhspugmaft12lcorhc8.apps.googleusercontent.com">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
		<script src="https://apis.google.com/js/platform.js?onload=onLoad" async defer></script>
		<script src="https://kit.fontawesome.com/df7e7c41fe.js" crossorigin="anonymous"></script>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <script src="https://www.gstatic.com/firebasejs/8.3.2/firebase.js"></script>
		
		<script src="scripts/script.js"></script>
		<script src="scripts/authorized.js"></script>
		
		<link rel="stylesheet" type="text/css" href="styles/styles.css">
		<link rel="stylesheet" type="text/css" href="styles/about.css">
		<link rel="stylesheet" typev="text/css" href="styles/pageheader.css">

		<link rel="icon" href="images/favicon.ico">
		
			<!-- Global site tag (gtag.js) - Google Analytics -->
			<script async src="https://www.googletagmanager.com/gtag/js?id=G-YGQJ626TH7%22%3E"></script>
			<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'G-YGQJ626TH7');
			</script>
	</head>

	<body>
		<div class="modal fade" id="setLabel" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                <h5 class="modal-title" style="color:black;" id="exampleModalLabel"></h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div style="color:black;" class="modal-body" id="label0B"></div>
                <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
            </div>
        </div>
		<div id="header">
            <nav class="navbar navbar-expand-lg"></nav>
            <h1 id="title">Password Reset </h1>
		</div>
		<div class="main-section"></div>
		
        <div class="field">
            <form action="javascript:changePassword();">
                <input style="color: black;" id="passwordA" type="text" placeholder="New Password" required>
                <input style="color: black;" id="passwordB" type="text" placeholder="Re-type password" required>
                <button style="color: black;" type="submit"> Reset Password </button>
            </form>
        </div>
        <script>
            const params = new URLSearchParams(document.location.search);
            const mode = params.get("mode");
            const oobCode = params.get("oobCode");

            if (mode == null || oobCode == null) {
                window.location = "index.html";
            }

            function changePassword() {
                let a = document.getElementById("passwordA").innerHTML;
                let b = document.getElementById("passwordB").innerHTML;

                if (a != b) {
                    setLabel('Error', 'New passwords must match');
                } else {
                    firebase.auth().confirmPasswordReset(oobCode, a).then(() => {
                        alert("Password reset successful!");
                    }).catch((error) => {
                        alert("Password reset attempt failed: oobCode in URL is incorrect.");

                        console.log(error);
                    });
                }
            }
        </script>
	</body>
</html>
